\documentclass{article}
\usepackage{ee105}

%% Makes figure labels bold
\usepackage[labelfont=bf]{caption}

\begin{document}

%% Prevent headings on the first page, since we're not using \maketitle
\thispagestyle{plain}

%% Standard header. Title of the lab goes here.
\prelab{1}{Introduction to SPICE}
\name

\begin{enumerate}
\item Before you begin, you will need some instructions on how to run and use HSPICE. We have a tutorial specifically for EE105 containing instructions for both the Windows and UNIX versions of HSPICE. The tutorial includes a number of examples to help you get started.
	
  \begin{itemize}
  \item \href{\baseurl/tutorials/HSPICE_Tutorial.pdf}{HSPICE Tutorial}
  \end{itemize}
  
\item Figure \ref{prelab} shows a simple network of resistors and a capacitor. Find the transfer functions $v_x/v_s$ and $v_y/v_s$ (as functions of $j\omega$) by hand.
  
  %% A file called "prelab.tex" is in the same directory as this file. This is how to include
  %% a figure generated by m4 and gpic.
  \begin{figure}[!htb]
    \input prelab
    \centerline{\box\graph}
    \caption{Circuit to simulate for the prelab}
    \label{prelab}
  \end{figure}
  
  ~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\
  \begin{align*}
    \boxed{\frac{v_x}{v_s} = ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~} \\ ~ \\
    \boxed{\frac{v_y}{v_s} = ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~}
  \end{align*}
  
\item Use the transfer functions you derived to make Bode plots (magnitude and phase) for $v_x/v_s$ and $v_y/v_s$. On each graph, indicate which curve is the magnitude and which is the phase. \note{If you need a review of Bode plots, read the \href{\baseurl/tutorials/Bode_Tutorial.pdf}{Bode Plot Tutorial}.}

  \begin{figure}[!htb]
    \begin{center}
      \begin{asy}
	import graph;
	texpreamble("\def\Arg{\mathop {\rm Arg}\nolimits}");
	
	size(15cm,10cm,IgnoreAspect);
	
	scale(Log,Linear);
	ylimits(-20,20);
	xlimits(100000.0,1000000000000.0);
	
	pen thin=linewidth(0.5*linewidth());
	
	xaxis("$\omega$ (rad/s)",BottomTop,LeftTicks(begin=false,end=false,extend=true,ptick=thin));
	yaxis("$|v_x/v_s|$ (dB)",Left,RightTicks(begin=false,end=false,N=0,n=0,Step=20,step=10));
	
	picture q=secondaryY(new void(picture pic) {
	  scale(pic,Log,Linear);
	  ylimits(pic,-45,45);
	  yaxis(pic,"$\Arg \left(v_x/v_s\right)$ (degrees)",Right,black,LeftTicks(begin=false,end=false,N=0,n=0,Step=45,step=15));
	  yequals(pic,0,Dotted);
	});
	add(q);
\end{asy}
    \end{center}
  \end{figure}

\pagebreak

  \begin{figure}[!htb]
    \begin{center}
      \begin{asy}
	import graph;
	texpreamble("\def\Arg{\mathop {\rm Arg}\nolimits}");
	
	size(15cm,10cm,IgnoreAspect);
	
	scale(Log,Linear);
	ylimits(-60,60);
	xlimits(100000.0,1000000000000.0);
	
	pen thin=linewidth(0.5*linewidth());
	
	xaxis("$\omega$ (rad/s)",BottomTop,LeftTicks(begin=false,end=false,extend=true,ptick=thin));
	yaxis("$|v_y/v_s|$ (dB)",Left,RightTicks(begin=false,end=false,N=0,n=0,Step=20,step=10));
	
	picture q=secondaryY(new void(picture pic) {
	  scale(pic,Log,Linear);
	  ylimits(pic,-135,135);
	  yaxis(pic,"$\Arg \left(v_y/v_s\right)$ (degrees)",Right,black,LeftTicks(begin=false,end=false,N=0,n=0,Step=45,step=15));
	  yequals(pic,0,Dotted);
	  yequals(pic,45,Dotted);
	  yequals(pic,90,Dotted);
	  yequals(pic,-45,Dotted);
	  yequals(pic,-90,Dotted);
	});
	add(q);
\end{asy}
    \end{center}
  \end{figure}

\item Now write an HSPICE netlist for this circuit.
\item Perform an AC analysis of this circuit from \unit{100}{\kilo\hertz} to \unit{1}{\tera\hertz} in HSPICE. Attach your netlist to this worksheet.
\item Use Awaves to generate Bode plots (magnitude and phase) for the circuit in Figure \ref{prelab} for $v_x/v_s$ and $v_y/v_s$. Do the results agree with your hand calculations? \hint{The default $x$-axis in Awaves has units \hertz, not \rad\per\second.} \note{If you do not have a 3-button mouse, you will not be able to generate a magnitude Bode plot. Instead, simply plot $\left|v_x/v_s\right|$ and $\left|v_y/v_s\right|$ on a log-log plot by right-clicking the axes and selecting ``Set Logarithmic Scale''.}
  \\~\\~\\~\\~\\
\item Turn in your hand calculations, netlist, and Bode plots (hand-made and simulated) at the beginning of your lab for checkoff. \textbf{Please print your plots with a white background. You can set a white background in Awaves by clicking \textit{Window} $\rightarrow$ \textit{Flip Color}.}
\end{enumerate}

\end{document}